<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Occupancy Grid Continental Task Ömer Cinar: Occupancy Grid Mapping Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Occupancy Grid Continental Task Ömer Cinar
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Occupancy Grid Mapping Documentation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This project develops a software in C++ designed to create an occupancy grid, also known as an obstacle map, from detections sourced from ultrasonic sensors mounted on a robot. This map is crucial for robotic navigation and environment interaction, especially in autonomous tasks.</p>
<h1><a class="anchor" id="project_desc"></a>
Project Description</h1>
<p>This project constructs an occupancy grid by integrating readings from four ultrasonic sensors positioned at the corners of a robot's chassis, each aligned at 45 degrees with respect to the robot’s axis. These sensors measure the environment within a 30-degree wide cone by emitting sound waves and detecting their echo.</p>
<p>The robot is additionally equipped with a 'magical' odometry sensor that provides precise x- and y-coordinates and orientation angles (in radians), starting from zero upon activation. This data, along with timestamps and sensor readings (time of flight in seconds), is processed from a CSV file to map the surrounding obstacles.</p>
<h1><a class="anchor" id="file_overview"></a>
File Overview</h1>
<ul>
<li><code><a class="el" href="main_8cpp.html">main.cpp</a></code>: Initializes the data processor and occupancy grid, reads sensor data from a CSV file, and outputs the occupancy grid to a file.</li>
<li><code><a class="el" href="data_processor_8hpp.html">dataProcessor.hpp</a>/cpp</code>: Defines methods for reading the CSV file and updating the occupancy grid based on sensor readings.</li>
<li><code><a class="el" href="occupancy_grid_8hpp.html">occupancyGrid.hpp</a>/cpp</code>: Contains the <a class="el" href="class_occupancy_grid.html" title="A class representing an occupancy grid for a robot.">OccupancyGrid</a> class which manages the grid data structure and performs calculations for mapping.</li>
<li><code><a class="el" href="sensor_8hpp.html">sensor.hpp</a></code>: Defines sensor properties including angle offsets and field of view.</li>
<li><code><a class="el" href="position_8hpp.html">position.hpp</a></code>: Simple structure to represent 2D positions.</li>
</ul>
<h2><a class="anchor" id="data_proc_sec"></a>
DataProcessor Class</h2>
<ul>
<li><b>CSV Data Reading</b>: The <a class="el" href="class_data_processor.html" title="A class for processing data for an occupancy grid.">DataProcessor</a> class is responsible for reading a CSV file containing the robot's sensory and positional data. The CSV file includes timestamps, robot coordinates, orientation, and sensor time-of-flight data.</li>
<li><b>Data Parsing and Grid Population</b>: After opening the CSV file, it iterates over each line, parsing the data into relevant double values. These values are then used to update the occupancy grid based on the robot's position and the sensor data.</li>
</ul>
<h2><a class="anchor" id="occ_grid_sec"></a>
OccupancyGrid Class</h2>
<ul>
<li><b>Grid Initialization</b>: The <a class="el" href="class_occupancy_grid.html" title="A class representing an occupancy grid for a robot.">OccupancyGrid</a> class initializes a 2D vector representing the grid. Each cell within this grid corresponds to a 10 cm x 10 cm area of the physical space the robot navigates.</li>
<li><b>Center <a class="el" href="struct_position.html" title="A struct that represents a position in 2D space.">Position</a> Calculation</b>: For each cell in the grid, its center position is calculated using its row and column indices. This helps in determining the exact location of the cell in relation to the robot.</li>
<li><b>Distance and Angle Calculation</b>: For each cell, the Euclidean distance and the angle relative to the robot’s orientation are calculated. These calculations are crucial for determining whether a cell lies within the sensor's effective range and field of view.</li>
</ul>
<h2><a class="anchor" id="algo_steps_sec"></a>
Detailed Algorithmic Steps</h2>
<ul>
<li><b>Converting <a class="el" href="struct_sensor.html" title="A struct representing a sensor on a robot.">Sensor</a> Time-of-Flight to Distance</b>: The time-of-flight data from each sensor is converted into distance using the formula distance = (time_of_flight * speed_of_sound) / 2. This conversion is necessary to understand how far away an object is based on the time it takes for the sound to return to the sensor.</li>
<li><b>Iterative Grid Update</b>: The entire grid is iterated through, cell by cell. For each cell, calculate its center's position relative to the robot. Calculate the distance and angle from the robot to the center of the cell. For each sensor on the robot, adjust the angle considering the sensor’s orientation offset and the robot’s heading. Determine if the cell lies within the field of view of any sensor by checking if the absolute angle difference is within half the sensor's beam angle. If a cell is within the sensor's range and field of view, and the calculated distance to the cell is less than or equal to the sensor's measured distance, mark it as occupied (1.0).</li>
<li><b>Finalizing the Grid</b>: After all cells have been evaluated, the grid is saved to a CSV file. This file stores the occupancy status (0 for free, 1 for occupied) of each cell, providing a visual representation of the area around the robot.</li>
</ul>
<h1><a class="anchor" id="conclusion_sec"></a>
Conclusion</h1>
<p>This approach ensures that all areas within the sensors' range are assessed for potential obstacles, providing a comprehensive map of the environment. The resulting occupancy grid is crucial for tasks such as path planning and navigation in robotics. The final grid is outputted as a CSV file, which can be used for further analysis or real-time navigation purposes. You can access the generated CSV file in the <code>debug</code> folder.</p>
<div class="image">
<img src="robot_test.png" alt=""/>
<div class="caption">
Occupancy Grid Image</div></div>
<h1><a class="anchor" id="usage"></a>
Usage</h1>
<p>This project uses CMake as its build system. To compile and run the project, follow these steps:</p>
<ol type="1">
<li>Open a terminal in the project's root directory.</li>
<li>Create a new directory named <code>build</code> and navigate into it: <code>mkdir build &amp;&amp; cd build</code></li>
<li>Run CMake to generate the build files: <code>cmake ..</code></li>
<li>Compile the project: <code>cmake --build .</code></li>
<li>Navigate to the <code>debug</code> directory: <code>cd debug</code></li>
<li>Run the executable with the path to the input CSV file specified: <code>.\main.exe</code></li>
</ol>
<p>Note: Don't forget to change the directory path of the <code>robot1.csv</code> in order to run and compile it successfully.</p>
<p>The output will be an occupancy grid saved in CSV format, representing detected obstacles.</p>
<p>To visualize the grid, you can run ./visu.py in the main directory. This script will generate a heatmap of the occupancy grid using matplotlib.</p>
<p>To run the test cases, after compiling the code navigate to the <code>debug</code> directory and run .\runUnitTests.exe`</p>
<p>Note: This project requires a C++17 or later compiler and has dependencies on Google Test, Python 3 or later, and NumPy. Make sure all dependencies are resolved before compiling. The project is configured to use the same runtime library for Google Test as your code to avoid conflicts.</p>
<h1><a class="anchor" id="references_sec"></a>
References</h1>
<p>[1] "Occupancy Grids, MathWorks", <a href="https://www.mathworks.com/help/robotics/ug/occupancy-grids.html">https://www.mathworks.com/help/robotics/ug/occupancy-grids.html</a></p>
<p>[2] "What is an Occupancy Grid Map?", <a href="https://automaticaddison.com/what-is-an-occupancy-grid-map/">https://automaticaddison.com/what-is-an-occupancy-grid-map/</a></p>
<p>[3] "Time-of-Flight principle", <a href="https://www.terabee.com/time-of-flight-principle/#:~:text=The%20Time%2Dof%2DFlight%20principle%20(ToF)%20is%20a,being%20reflected%20by%20an%20object">https://www.terabee.com/time-of-flight-principle/#:~:text=The%20Time%2Dof%2DFlight%20principle%20(ToF)%20is%20a,being%20reflected%20by%20an%20object</a>. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
